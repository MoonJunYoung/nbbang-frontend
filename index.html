<!doctype html>
<html lang="ko">
    <head>
        <meta charset="utf-8" />
        <link rel="png" href="/public/images/nbbang.png" />
        <meta property="og:url" content="nbbang.life" />
        <meta property="og:title" content="엔빵" />
        <meta property="og:type" content="website" />
        <meta property="og:image" content="nbbangMetaPng.png" />
        <meta property="og:description" content="빠른 정산, 원클릭 송금" />
        <meta
            http-equiv="Content-Security-Policy"
            content="upgrade-insecure-requests"
        />
        <link rel="icon" href="favicon.ico" />
        <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
            rel="stylesheet"
        />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
        <meta name="theme-color" content="#0044FE" />
        <link rel="icon" type="image/png" href="/public/images/nbbang.png" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="theme-color" content="#0044FE" />
        <link rel="apple-touch-icon" href="/public/images/nbbang.png" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"
        />
        <meta name="description" content="빠른 정산, 원클릭 송금" />
        <title>엔빵</title>
        <script>
            (function () {
                console.log("🚀 [서비스 워커 제거 스크립트 실행]");
                
                // ✅ 무한 리로드 방지: 새로고침 여부 체크
                if (!localStorage.getItem("reloadOnce")) {
                    localStorage.setItem("reloadOnce", "true"); // 새로고침 플래그 저장
        
                    // 1️⃣ 서비스 워커 해제
                    if ("serviceWorker" in navigator) {
                        navigator.serviceWorker.getRegistrations().then((registrations) => {
                            registrations.forEach((registration) => {
                                registration.unregister().then(() => {
                                    console.log("✅ [서비스 워커 삭제 완료]");
                                });
                            });
                        });
                    }
        
                    // 2️⃣ 기존 캐시 삭제 (JS, API 응답 등)
                    if (window.caches) {
                        caches.keys().then((cacheNames) => {
                            cacheNames.forEach((cacheName) => {
                                caches.delete(cacheName).then(() => {
                                    console.log(`✅ [캐시 삭제 완료]: ${cacheName}`);
                                });
                            });
                        });
                    }
        
                    // 3️⃣ 강제 새로고침 (한 번만 실행)
                    setTimeout(() => {
                        window.location.reload(true);
                    }, 2000); // 2초 후 실행
                } else {
                    console.log("🛑 [서비스 워커 제거 스크립트] 이미 실행됨, 새로고침 방지");
                    localStorage.removeItem("reloadOnce"); // 플래그 초기화
                }
            })();
        </script>
    </head>
    <body>
        <noscript>You need to enable JavaScript to run this app.</noscript>
        <div id="root"></div>
        <script type="module" src="/src/main.jsx"></script>
    </body>
</html>
